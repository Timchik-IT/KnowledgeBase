##### Основные команды и инструменты [[Консоль||работы через консоль]]

## 1. **Основные понятия**
   - **Файервол (Firewall)** — это система, которая контролирует входящий и исходящий сетевой трафик на основе предопределенных правил безопасности.
   - **UFW (Uncomplicated Firewall)** — простой в использовании интерфейс для управления файерволом в Linux, основанный на `iptables`.

## 2. **Установка и включение UFW**
   - Установка UFW:
     ```bash
     sudo apt update
     sudo apt install ufw
     ```
   - Включение UFW:
     ```bash
     sudo ufw enable
     ```

## 3. **Блокировка трафика**
   - **Блокировка портов:**
     - Блокировка SSH (порт 22):
       ```bash
       sudo ufw deny 22
       ```
     - Блокировка HTTP (порт 80):
       ```bash
       sudo ufw deny 80
       ```
     - Блокировка HTTPS (порт 443):
       ```bash
       sudo ufw deny 443
       ```
   - **Проверка статуса файервола:**
     ```bash
     sudo ufw status verbose
     ```

## 4. **Настройка TTL (Time To Live)**
   - **Изменение TTL для исходящих пакетов:**
     ```bash
     sudo iptables -t mangle -A OUTPUT -j TTL --ttl-set 100
     ```
   - **Сохранение правил iptables:**
     Установка `iptables-persistent` для сохранения правил после перезагрузки:
     ```bash
     sudo apt install iptables-persistent
     ```

## 5. **Проверка работы**
   - **Проверка блокировки трафика:**
     Попробуйте подключиться к заблокированным портам с другой машины:
     ```bash
     ssh user@your_mint_ip
     curl http://your_mint_ip
     ```
   - **Проверка TTL:**
     Используйте `ping` для проверки TTL:
     ```bash
     ping your_mint_ip
     ```

## 6. **Дополнительные рекомендации**
   - **Резервное копирование правил:**
     ```bash
     sudo ufw status verbose > ufw_backup.txt
     ```
   - **Сброс правил:**
     ```bash
     sudo ufw reset
     ```
   - **Графический интерфейс (GUFW):**
     Установка графической оболочки для UFW:
     ```bash
     sudo apt install gufw
     ```

## 7. **Важные моменты**
   - **Зоны в файерволе:** В `firewalld` (используется в Red Hat) трафик классифицируется по зонам (например, public, home, internal). В UFW такой концепции нет, но можно настроить правила для конкретных интерфейсов.
   - **Предопределенные сервисы:** В `firewalld` есть предопределенные сервисы (например, `ssh`, `http`), которые упрощают настройку. В UFW можно использовать аналогичные правила для портов.
   - **Логирование:** UFW по умолчанию логирует все действия. Логи можно найти в `/var/log/ufw.log`.

## 8. **Полезные команды**
   - **Просмотр всех правил:**
     ```bash
     sudo ufw status numbered
     ```
   - **Удаление правила:**
     ```bash
     sudo ufw delete <номер правила>
     ```
   - **Отключение UFW:**
     ```bash
     sudo ufw disable
     
     ```