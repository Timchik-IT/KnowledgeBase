[[Классы, структуры и пространства имен в dotnet]]

Кроме стандартных значений типа чисел, строк, язык C# имеет специальное значение - `null`, которое фактически указывает на отсутствие значения как такового, отсутствие данных. До сих пор значение `null` выступает как значение по умолчанию для ссылочных типов.

До версии C# 8.0 всем ссылочным типам спокойно можно было присваивать значение null:

``` cs 
string name = null;
Console.WriteLine(name); 
```

Но начиная с версии C# 8.0 в язык была введена концепция ссылочных **nullable-типов** (nullable reference types) и **nullable aware context** - nullable-контекст, в котором можно использовать ссылочные nullable-типы.

Чтобы определить переменную/параметр ссылочного типа, как переменную/параметр, которым можно присваивать значение `null`, после названия типа указывается знак вопроса `?`

``` cs 
string? name = null;
Console.WriteLine(name);    // ничего не выведет
```

При этом подобные ссылочные типы, которые допускают присвоение значения `null`, доступно только в nullable-контексте. Для nullable-контекста характерны следующие особенности:

- Переменную ссылочного типа следует инициализировать конкретным значением, ей не следует присваивать значение `null`

- Переменной ссылочного nullable-типа можно присвоить значение `null`, но перед использование необходимо проверять ее на значение `null`.

### Оператор `!` (null-forgiving operator)

Оператор `!` (null-forgiving operator) позволяет указать, что переменная ссылочного типа не равна `null`:

``` cs 
string? name = null;
 
PrintUpper(name!);
 
void PrintUpper(string text)
{
    if(text == null) Console.WriteLine("null");
    else Console.WriteLine(text.ToUpper());
}
```

Здесь если бы мы не использовали оператор `!`, а написали бы `PrintUpper(name)`, то компилятор высветил бы нам предупреждение.

### Оператор ??

Оператор `??` называется оператором **null-объединения**. Он применяется для установки значений по умолчанию для типов, которые допускают значение `null`:

``` cs 
левый_операнд ?? правый_операнд
```

Оператор `??` возвращает левый операнд, если этот операнд не равен `null`. Иначе возвращается правый операнд. При этом левый операнд должен принимать `null`. Посмотрим на примере:

``` cs 
string? text = null;
string name = text ?? "Tom";  // равно Tom, так как text равен null
Console.WriteLine(name);    // Tom
 
int? id = 200;
int personid = id ?? 1; // равно 200, так как id не равен null
Console.WriteLine(personid);    // 200
```

Но мы не можем написать следующим образом:

``` cs 
int x = 44;
int y = x ?? 100;
```

Здесь переменная `x` представляет значимый тип `int` и не может принимать значение `null`, поэтому в качестве левого операнда в операции `??` она использоваться не может.

##### Также можно использовать производный оператора `??=`

``` cs 
string? text = null;
text ??= "Sam";
// аналогично
// text = text ?? "Sam";
Console.WriteLine(text);    // Sam
 
int? id = 100;
id ??= 1;
// аналогично
//id = id ?? 1;
Console.WriteLine(id); // 100
```

### Оператор условного null

#### Пишем **не** так:
``` cs 
void PrintWebSite(Person? person)
{
    if (person != null)
    {
        if(person.Company != null)
        {
            if(person.Company.WebSite != null)
            {
	            Console.WriteLine
	            (person.Company.WebSite.ToUpper());
            }
        }
    }
}
```
#### Пишем так:
``` cs 
void PrintWebSite(Person? person)
{
    Console.WriteLine(person?.Company?.WebSite?.ToUpper());
}
```

