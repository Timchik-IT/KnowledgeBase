
[[ООП в dotnet]]

Кроме обычных типов фреймворк .NET также поддерживает обобщенные типы (generics), а также создание обобщенных методов.

Когда мы приводим один тип к другому происходят такие явления как упаковка (_boxing_) и распаковка (_unboxing_).

Упаковка (boxing) предполагает преобразование объекта значимого типа (например, типа int) к типу `object`. При упаковке общеязыковая среда CLR обертывает значение в объект типа `System.Object` и сохраняет его в управляемой куче (хипе). Распаковка (unboxing), наоборот, предполагает преобразование объекта типа `object` к значимому типу. Упаковка и распаковка ведут к снижению производительности, так как системе надо осуществить необходимые преобразования.

Для решения этих проблем в язык C# была добавлена поддержка _обобщенных типов_ (также часто называют универсальными типами). Обобщенные типы позволяют указать конкретный тип, который будет использоваться.

``` cs 
class Person<T>
{
    public T Id { get; set; }
    public string Name { get; set; }
    public Person(T id, string name)
    {
        Id = id; 
        Name = name;
    }
}
```

Угловые скобки в описании `class Person<T>` указывают, что класс является обобщенным, а тип **T**, заключенный в угловые скобки, будет использоваться этим классом. Необязательно использовать именно букву **T**, это может быть и любая другая буква или набор символов. Причем сейчас на этапе написания кода нам неизвестно, что это будет за тип, это может быть любой тип. Поэтому параметр **T** в угловых скобках еще называется универсальным параметром, так как вместо него можно подставить любой тип.

### Статические поля обобщенных классов

При типизации обобщенного класса определенным типом будет создаваться свой набор статических членов. Например, в классе Person определено следующее статическое поле:

``` cs 
class Person<T>
{
    public static T? code;
    public T Id { get; set; }
    public string Name { get; set; }
    public Person(T id, string name)
    {
        Id = id; 
        Name = name;
    }
}
```


### Использование нескольких универсальных параметров

Обобщения могут использовать несколько универсальных параметров одновременно, которые могут представлять одинаковые или различные типы:

``` cs 
class Person<T, K>
{
    public T Id { get;}
    public K Password { get; set; }
    public string Name { get;}
    public Person(T id, K password, string name)
    {
        Id = id; 
        Name = name;
        Password = password;
    }
}
```


### Обобщенные методы

Кроме обобщенных классов можно также создавать обобщенные методы, которые точно также будут использовать универсальные параметры. Например:

``` cs 
int x = 7;
int y = 25;
Swap<int>(ref x, ref y); // или так Swap(ref x, ref y);
Console.WriteLine($"x={x}    y={y}");   // x=25   y=7
 
string s1 = "hello";
string s2 = "bye";
Swap<string>(ref s1, ref s2); // или так Swap(ref s1, ref s2);
Console.WriteLine($"s1={s1}    s2={s2}"); // s1=bye   s2=hello
 
void Swap<T>(ref T x, ref T y)
{
    T temp = x;
    x = y;
    y = temp;
}
```

Здесь определен обощенный метод Swap, который принимает параметры по ссылке и меняет их значения. При этом в данном случае не важно, какой тип представляют эти параметры.

При вызове метода Swap типизируем его определенным типом и передаем ему соответствующие этому типу значения.