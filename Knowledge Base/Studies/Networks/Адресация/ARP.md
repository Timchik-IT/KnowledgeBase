
ARP (Address Resolution Protocol - протокол определения адреса) - протокол в компьютерных сетях, предназначенный для определения [[MAC]]-адреса другого компьютера по известному IP-адресу.

Описание протокола было опубликовано в ноябре 1982 года в RFC 826. ARP был спроектирован для передачи IP-пакетов через пакеты (кадры) Ethernet. Принцип выяснения аппаратного адреса целевого хоста, использованный в ARP, был затем использован в сетях других типов.

#### **Об Address Resolution Protocol (ARP):**

- ARP используется для определения MAC-адреса устройства на основе его IP-адреса.
- Протокол выполняет ключевую функцию в IP-маршрутизации и поддерживает связь между уровнями 2 и 3 модели OSI.
- ARP создает и поддерживает таблицу соответствий MAC-адресов и IP-адресов (ARP-таблица).

#### **Типы ARP-записей:**
1. **Динамические записи:**
- Добавляются автоматически устройствами на основе ARP-запросов.
- Имеют ограниченный срок действия (по умолчанию 4 часа, но это значение можно изменить).

1. **Статические записи:**
- Настраиваются вручную.
- Постоянны и не удаляются автоматически.
- Используются для устройств, которые постоянно взаимодействуют друг с другом.

#### **Особенности работы ARP:**

1. **Кэширование ARP-записей:**
- Снижает нагрузку на сеть, уменьшая количество ARP-запросов.
- Срок действия записей в кэше можно настроить.

2. **Запросы ARP:**
- Если запись отсутствует в кэше, устройство отправляет широковещательный запрос, чтобы найти MAC-адрес для указанного IP.
- Только устройство с соответствующим IP-адресом отвечает, предоставляя свой MAC-адрес.

3. **Если адрес назначения находится в удаленной сети:**
- Устройство отправляет ARP-запрос для MAC-адреса шлюза по умолчанию.

## Структура пакета ARP

Ниже проиллюстрирована структура пакета, используемого в запросах и ответах ARP. В сетях Ethernet в этих пакетах используется EtherType 0x0806, и запросы рассылаются на широковещательный MAC-адрес — FF:FF:FF:FF:FF:FF. Отметим, что в структуре пакета, показанной ниже, в качестве SHA, SPA, THA и TPA условно используются 32-битные слова — реальная длина определяется физическим устройством и протоколом.

![[Pasted image 20241203203617.png]]
- **Hardware type (HTYPE)**
Каждый канальный протокол передачи данных имеет свой номер, который хранится в этом поле. Например, Ethernet имеет номер 0x0001.

- **Protocol type (PTYPE)**
Код сетевого протокола. Например, для IPv4 будет записано 0x0800.

- **Hardware length (HLEN)**
Длина физического адреса в байтах. Адреса Ethernet имеют длину 6 байт (0x06).

- **Protocol length (PLEN)**
Длина логического адреса в байтах. IPv4 адреса имеют длину 4 байта (0x04).

- **Operation**
Код операции отправителя: 0x0001 в случае запроса и 0x0002 в случае ответа.

- **Sender hardware address (SHA)**
Физический адрес отправителя.

- **Sender protocol address (SPA)**
Логический адрес отправителя.

- **Target hardware address (THA)**
Физический адрес получателя. Не требуется при запросе.

- **Target protocol address (TPA)**
Логический адрес получателя.